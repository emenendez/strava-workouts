"use strict";var app=angular.module("stravaWorkoutsApp",["ngResource","ngTouch"]);app.directive("progressBar",function(){return{restrict:"E",scope:{title:"@",workouts:"="},templateUrl:"progress-bar.html",controller:["$scope",function(a){a.incomplete=[1,2,3]}]}}),angular.module("stravaWorkoutsApp").config(["$locationProvider",function(a){a.html5Mode(!0)}]).controller("MainCtrl",["$scope","$location","$window","$http",function(a,b,c,d){var e=new Date,f=e.getDay()-1;if(-1===f&&(f=6),e.setDate(e.getDate()-f),e.setHours(0,0,0,0),a.start=e,!b.search().code)return void(c.location.href="https://www.strava.com/oauth/authorize?client_id=6518&response_type=code&redirect_uri=http://emenendez.github.io/strava-workouts/");AWS.config.update({accessKeyId:"AKIAJBA62LHLZVTZSJ3A",secretAccessKey:"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"}),AWS.config.region="us-east-1";var g=new AWS.Lambda;g.invoke({FunctionName:"stravaWorkoutsGetToken",Payload:'{"code": "'+b.search().code+'"}'},function(b,c){if(b)console.log(b,b.stack);else{var f=angular.fromJson(c.Payload).access_token;d.jsonp("https://www.strava.com/api/v3/athlete/activities",{params:{access_token:f,callback:"JSON_CALLBACK",after:Math.floor(e.getTime()/1e3)}}).success(function(b,c,d,e){a.activities={};for(var f=0;f<b.length;++f){var g=b[f];a.activities[g.type]||(a.activities[g.type]=[]),a.activities[g.type].push(g)}}).error(function(a,b,c,d){console.log(a)})}})}]);